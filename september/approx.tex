




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%									%
% Mistaken Taylor approximations about p_i and p_j			%
% What we actually want to do is expand the product, then remove	%
% all the terms of order higher than 1, because they are negligable.	%
%									%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%














% !TEX TS-program = pdflatex
% !TEX encoding = UTF-8 Unicode

% This is a simple template for a LaTeX document using the "article" class.
% See "book", "report", "letter" for other types of document.

\documentclass[11pt]{article} % use larger type; default would be 10pt


\usepackage{ulem}
\newcommand\NoIndent[1]{%
  \par\vbox{\parbox[t]{\linewidth}{#1}}%
}


\usepackage[utf8]{inputenc} % set input encoding (not needed with XeLaTeX)

%%% Examples of Article customizations
% These packages are optional, depending whether you want the features they provide.
% See the LaTeX Companion or other references for full information.

%%% PAGE DIMENSIONS
\usepackage{geometry} % to change the page dimensions
\geometry{a4paper} % or letterpaper (US) or a5paper or....
% \geometry{margin=2in} % for example, change the margins to 2 inches all round
% \geometry{landscape} % set up the page for landscape
%   read geometry.pdf for detailed page layout information

\usepackage{graphicx} % support the \includegraphics command and options

% \usepackage[parfill]{parskip} % Activate to begin paragraphs with an empty line rather than an indent

%%% PACKAGES
\usepackage{booktabs} % for much better looking tables
\usepackage{array} % for better arrays (eg matrices) in maths
\usepackage{paralist} % very flexible & customisable lists (eg. enumerate/itemize, etc.)
\usepackage{verbatim} % adds environment for commenting out blocks of text & for better verbatim
\usepackage{subfig} % make it possible to include more than one captioned figure/table in a single float
% These packages are all incorporated in the memoir class to one degree or another...

%%% HEADERS & FOOTERS
\usepackage{fancyhdr} % This should be set AFTER setting up the page geometry
\pagestyle{fancy} % options: empty , plain , fancy
\renewcommand{\headrulewidth}{0pt} % customise the layout...
\lhead{}\chead{}\rhead{}
\lfoot{}\cfoot{\thepage}\rfoot{}

%%% SECTION TITLE APPEARANCE
\usepackage{sectsty}
\allsectionsfont{\sffamily\mdseries\upshape} % (See the fntguide.pdf for font help)
% (This matches ConTeXt defaults)

%%% ToC (table of contents) APPEARANCE
\usepackage[nottoc,notlof,notlot]{tocbibind} % Put the bibliography in the ToC
\usepackage[titles,subfigure]{tocloft} % Alter the style of the Table of Contents
\renewcommand{\cftsecfont}{\rmfamily\mdseries\upshape}
\renewcommand{\cftsecpagefont}{\rmfamily\mdseries\upshape} % No bold!

%%% END Article customizations


\usepackage{verbatim}


\begin{document}

%%% To switch from 1 + p/(1-p) to 1/(1-p), try...
%s/1+\\frac{p_{j}}{1-p_{j}}/\\\frac{1}{1-p_{j}}/g

%%% To switch to 1 + p/(1-p) from 1/(1-p), try...
%s/1+\\frac{p_{j}}{1-p_{j}}/1+\\frac{p_{j}}{1-p_{j}}/g


First order approximation about $p_{ic} = 0$ is
$$f(0) + f'(0)*(p_{ic}-0)
%% p_{ic} * f'(0) %%
= p_{ic}\left(
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\prod_{j=i+1}^{n}(\frac{1}{1-p_{j}})\right]
\right)
$$

Where

$p_{ic}$ is the probability of a nonsense error at position $i$ using codon $c$

$p_j$ is the probability of a nonsense error at position $j$ (using any codon)

$$f(p_{ic})=
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\frac{p_{ic}}{1-p_{ic}}\right]
\left[\prod_{j=i+1}^{n}(\frac{1}{1-p_{j}})\right]$$

So...

$$
f(0)=
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\prod_{j=i+1}^{n}(\frac{1}{1-p_{j}})\right]
\left[\frac{0}{1-0}\right]$$

$$f(0)=0$$


\noindent\makebox[\linewidth]{\rule{\textwidth}{1pt}} 

~

$$f'(p_{ic}) = \frac{\delta}{\delta p_{ic}}f(p_{ic})=
\frac{\delta}{\delta p_{ic}}\left(
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\frac{p_{ic}}{1-p_{ic}}\right]
\left[\prod_{j=i+1}^{n}(\frac{1}{1-p_{j}})\right]
\right)$$

$$=
\left(
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\prod_{j=i+1}^{n}(\frac{1}{1-p_{j}})\right]
\right)
\frac{\delta}{\delta p_{ic}}
\left[\frac{p_{ic}}{1-p_{ic}}\right]
$$

$$=
\left(
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\prod_{j=i+1}^{n}(\frac{1}{1-p_{j}})\right]
\right)
%%%quotient rule%%
\left[\frac{(1-p_{ic})(1) - p_{ic}(-1)}
{(1-p_{ic})^2}\right]
$$

$$=
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\prod_{j=i+1}^{n}(\frac{1}{1-p_{j}})\right]
\left[\frac{1}
{(1-p_{ic})^2}\right]
$$

So...

$$f'(0)=
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\prod_{j=i+1}^{n}(\frac{1}{1-p_{j}})\right]
\left[\frac{1}
{(1-0)^2}\right]
$$

$$=
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\prod_{j=i+1}^{n}(\frac{1}{1-p_{j}})\right]
$$

~

\noindent\makebox[\linewidth]{\rule{\textwidth}{1pt}} 

~

$$f''(p_{ic})=
\frac{\delta}{\delta p_{ic}}\left(
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\prod_{j=i+1}^{n}(\frac{1}{1-p_{j}})\right]
\left[\frac{1}
{(1-p_{ic})^2}\right]
\right)
$$


$$f''(p_{ic})=
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\prod_{j=i+1}^{n}(\frac{1}{1-p_{j}})\right]
\frac{\delta}{\delta p_{ic}}
\left[
(1-p_{ic})^{-2}
\right]
$$

$$f''(p_{ic})=
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\prod_{j=i+1}^{n}(\frac{1}{1-p_{j}})\right]
\left[
-2 (1-p_{ic})^{-3} (-1)
\right]
$$

$$f''(p_{ic})=
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\prod_{j=i+1}^{n}(\frac{1}{1-p_{j}})\right]
\left[
2 (1-p_{ic})^{-3}
\right]
$$

So...

$$f''(0)=
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\prod_{j=i+1}^{n}(\frac{1}{1-p_{j}})\right]
\left[
2 (1-0)^{-3}
\right]
$$

$$=
2
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\prod_{j=i+1}^{n}(\frac{1}{1-p_{j}})\right]
$$


%%% Begin Other Option %%%

\newpage


Based on what we've talked about with the math, it may be possible that Mike meant to assume $p_{i+1} \approx p_{i+2} \approx \cdots \approx p_{n}$. This feels risky. They are all sufficiently close to 0, but approximating them all at once is suspect. For the first codon in a gene of length 400, $p_j$ incorporates as many as $3^{399}$ different values. Treating them as the same value $p_j$ doesn't really respect the biology, but doing a multivariable Taylor approximation as a single variable approximation doesn't respect the math.

Regardless, here is the approximation. To keep in the spirit of $p_{j} \neq p_{j+1}$, I will not simplify $\left[\prod_{j=i+1}^{n}(\frac{1}{1-p_{j}})\right]$ to $\frac{1}{(1-p_{j})^{n-(i+1)}}$, though the calculation actually comes out the same either way.

The final result, the approximation about $p_{i+1}, \cdots, p_n \approx 0$ is

$$
f(p_j) \approx
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\frac{p_{ic}}{1-p_{ic}}\right]
+
\left( (i+1) - n \right)
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\frac{p_{ic}}{1-p_{ic}}\right]
\left( p_{j} \right)
$$


$$
f(p_j) \approx
f(0) + (f(0))(p_j)((i+1)-n)
$$

I'm concerned about that last $p_j$ term that is added to the first order term. What is that? We approximated around $p_{i+1} \approx p_{i+2} \approx \cdots \approx p_n$

\noindent\makebox[\linewidth]{\rule{\textwidth}{1pt}} 


$$
f(p_{j})=
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\frac{p_{ic}}{1-p_{ic}}\right]
\left[\prod_{j=i+1}^{n}(\frac{1}{1-p_{j}})\right]
$$

So...

$$
f(0) = 
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\frac{p_{ic}}{1-p_{ic}}\right]
\left[\prod_{j=i+1}^{n}(\frac{1}{1-0})\right]
$$

$$
f(0) = 
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\frac{p_{ic}}{1-p_{ic}}\right]
$$


\noindent\makebox[\linewidth]{\rule{\textwidth}{1pt}} 


$$
f'(p_{j})=\frac{\delta}{\delta p_{j}}
\left(
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\frac{p_{ic}}{1-p_{ic}}\right]
\left[\prod_{j=i+1}^{n}(\frac{1}{1-p_{j}})\right]
\right)
$$

Which I'm going to restate for simplicity as 

$$
f'(p_{j})=
\left( f(0) \right)
\frac{\delta}{\delta p_{j}}
\left(\prod_{j=i+1}^{n}\frac{1}{1-p_{j}}\right)
$$


$$
f'(p_{j})=
\left( f(0) \right)
\left( \sum_{j=i+1}^{n} \frac{-1}{(1-p_{j})^2} \right)
\left( \prod_{j=i+1, j \neq i}^{n} \frac{1}{1-p_{j}}\right)
$$

So...

$$
f'(0)=
\left( f(0) \right)
\left( \sum_{j=i+1}^{n} \frac{-1}{(1-0)^2} \right)
\left( \prod_{j=i+1, j \neq i}^{n} \frac{1}{1-0}\right)
$$


$$
f'(0)=
\left( f(0) \right)
\left( \sum_{j=i+1}^{n} \frac{-1}{(1-0)^2} \right)
\left( \prod_{j=i+1, j \neq i}^{n} \frac{1}{1-0}\right)
$$

$$
f'(0)=
\left( f(0) \right)
\left( (i+1) - n \right)
=\left( (i+1) - n \right)
\left[\sum_{k=1}^{i} a_1 + a_2(k-1)\right]
\left[\frac{p_{ic}}{1-p_{ic}}\right]
$$


\end{document}

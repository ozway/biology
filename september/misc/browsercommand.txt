if(TRUE%in%is.nan(lp.vec)) {    browser();      }
